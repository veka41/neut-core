import {
  this.char {Char1, Char2, Char3, Char4, char},
  this.list,
  this.show {Show, show},
  this.text {create, join, text, text-byte-length},
  this.text.show {_quote},
}

define show-char(ch: char): text {
  let base =
    match ch {
    | Char1(x1) =>
      create([x1])
    | Char2(x1, x2) =>
      create([x1, x2])
    | Char3(x1, x2, x3) =>
      create([x1, x2, x3])
    | Char4(x1, x2, x3, x4) =>
      create([x1, x2, x3, x4])
    }
  in
  let len on base = text-byte-length(base) in
  let result on base = join(_quote(base, len, 0, 0)) in
  let _ = base in
  result
}

constant as-show: show(char) {
  Show of {
    show = show-char,
  }
}
